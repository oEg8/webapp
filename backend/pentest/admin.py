from django.contrib import admin

from .models import AuthToken, PentestRequest, PentestScan, UserProfile


@admin.register(UserProfile)
class UserProfileAdmin(admin.ModelAdmin):
    list_display = ("user", "target_ip", "credits", "mfa_enabled")
    search_fields = ("user__username", "user__email", "target_ip")
    list_filter = ("mfa_enabled",)


@admin.register(PentestRequest)
class PentestRequestAdmin(admin.ModelAdmin):
    list_display = ("client_name", "contact_email", "status", "created_at")
    search_fields = ("client_name", "contact_email", "scope")
    list_filter = ("status",)


@admin.register(PentestScan)
class PentestScanAdmin(admin.ModelAdmin):
    list_display = ("user", "engine", "target_ip", "status", "created_at")
    search_fields = ("user__username", "target_ip")
    list_filter = ("status", "engine")


@admin.register(AuthToken)
class AuthTokenAdmin(admin.ModelAdmin):
    list_display = ("user", "key", "created_at")
    search_fields = ("user__username", "key")
